
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-redhat-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> setwd("/data1/RPred/")
> repoDir = "/data1/R-repo"
> if ( ! any(.libPaths() == repoDir) ) {
+     .libPaths( c( .libPaths(), "/data1/R-repo/") )
+ }
> 
> library(caret)
Loading required package: lattice
Loading required package: ggplot2
> library(doMC)
Loading required package: foreach
Loading required package: iterators
Loading required package: parallel
> registerDoMC(cores = 8)
> 
> load("pml_base.RDA")
> load("pca_data.RDA")
> 
> system.time({
+         modelFit_nb <- train(x = training[,predictionCols], 
+                               y = training$classe,
+                               method="nb")
+ })
Loading required package: klaR
Loading required package: MASS
    user   system  elapsed 
2033.250    1.262  606.733 
> 
> print(confusionMatrix(training$classe, predict(modelFit_nb, newdata=training[,predictionCols])))
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 3536   89   72  201    8
         B  518 1758  246  112   24
         C  428  148 1724   95    1
         D  329    5  336 1515   67
         E  130  257  106   79 1953

Overall Statistics
                                          
               Accuracy : 0.7633          
                 95% CI : (0.7561, 0.7704)
    No Information Rate : 0.3597          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.6978          
 Mcnemar's Test P-Value : < 2.2e-16       

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.7156   0.7789   0.6940   0.7567   0.9513
Specificity            0.9579   0.9216   0.9403   0.9372   0.9510
Pos Pred Value         0.9053   0.6614   0.7195   0.6727   0.7735
Neg Pred Value         0.8571   0.9550   0.9330   0.9576   0.9911
Prevalence             0.3597   0.1643   0.1808   0.1457   0.1495
Detection Rate         0.2574   0.1280   0.1255   0.1103   0.1422
Detection Prevalence   0.2843   0.1935   0.1744   0.1639   0.1838
Balanced Accuracy      0.8368   0.8503   0.8172   0.8470   0.9512
There were 50 or more warnings (use warnings() to see the first 50)
> 
> print(confusionMatrix(testing$classe, predict(modelFit_nb, newdata=testing[,predictionCols])))
Confusion Matrix and Statistics

          Reference
Prediction    A    B    C    D    E
         A 1505   33   41   87    8
         B  229  743  110   51    6
         C  195   63  732   36    0
         D  138    3  151  639   33
         E   66  113   34   39  830

Overall Statistics
                                          
               Accuracy : 0.756           
                 95% CI : (0.7448, 0.7669)
    No Information Rate : 0.3624          
    P-Value [Acc > NIR] : < 2.2e-16       
                                          
                  Kappa : 0.6883          
 Mcnemar's Test P-Value : < 2.2e-16       

Statistics by Class:

                     Class: A Class: B Class: C Class: D Class: E
Sensitivity            0.7056   0.7780   0.6854   0.7500   0.9464
Specificity            0.9550   0.9197   0.9390   0.9354   0.9497
Pos Pred Value         0.8990   0.6523   0.7135   0.6629   0.7671
Neg Pred Value         0.8509   0.9553   0.9308   0.9567   0.9902
Prevalence             0.3624   0.1623   0.1815   0.1448   0.1490
Detection Rate         0.2557   0.1263   0.1244   0.1086   0.1410
Detection Prevalence   0.2845   0.1935   0.1743   0.1638   0.1839
Balanced Accuracy      0.8303   0.8488   0.8122   0.8427   0.9480
There were 50 or more warnings (use warnings() to see the first 50)
> 
> save(modelFit_nb, file = "modelFit_nb.RDA", compress="gzip")
> 
> 
